sd=1.090389)
a<-dnorm(x_mean, mean=10.855893,
sd=1.090389)
a<-pnorm(x_mean, mean=10.855893,
sd=1.090389)
a<-pnorm(11, mean=10.855893,
sd=1.090389)
a<-pnorm(10.85, mean=10.855893,
sd=1.090389)
a<-pnorm(8, mean=10.855893,
sd=1.090389)
a<-pnorm(12, mean=10.855893,
sd=1.090389)
a<-pnorm(x_mean, mean=10.855893,
sd=1.090389)
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = mvn_info$mode[1] ,
Sigma = exp(mvn_info$mode[2]) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(mvn_info$mode[2]) )
}
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = mvn_info$mode[1] ,
Sigma = exp(mvn_info$mode[2]) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(mvn_info$mode[2] )
}
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = mvn_info$mode[1] ,
Sigma = exp(mvn_info$mode[2]) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(mvn_info$mode[2]) )
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = mvn_info$mode[1] ,
Sigma = exp(mvn_info$mode[2]) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = )
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = mvn_info$mode[1] ,
Sigma = exp(mvn_info$var_matrix) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(Sigma))
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
set.seed(202004)
#post_samples <- generate_post_samples(laplace_result, 10000)
laplace_result$var_matrix
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu =  ,
Sigma =  ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = )
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = rep(0, 2) ,
Sigma = diag(2) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = )
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = rep(0, 2) ,
Sigma = diag(2) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(Sigma))
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = rep(0, 2) ,
Sigma = diag(2) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(varphi))
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
#laplace_result$var_matrix
post_samples %>% ggplot(aes(x=mu))
post_samples %>% ggplot(aes(x=mu))+histogram()
post_samples %>% ggplot(aes(x=mu))+geom_histogram(bins = 55)
post_samples %>% ggplot(aes(x=mu))+geom_histogram(bins = 55)
post_samples %>% ggplot(aes(x=vaphi))+geom_histogram(bins = 55)
#post_samples %>% ggplot(aes(x=mu))+geom_histogram(bins = 55)
post_samples %>% ggplot(aes(x=varphi))+geom_histogram(bins = 55)
post_samples %>% ggplot(aes(x=mu))+geom_histogram(bins = 55)
#post_samples %>% ggplot(aes(x=varphi))+geom_histogram(bins = 55)
post_samples %>% ggplot(aes(x=mu))+geom_histogram(bins = 55)
post_samples %>% ggplot(aes(x=varphi))+geom_histogram(bins = 55)
View(post_samples)
post_samples %>% ggplot(aes(x=sigma))+geom_histogram(bins = 55)
dnorm(4,mean(post_samples$sigma))
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = rep(0, 2) ,
Sigma = diag(2) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = log(varphi))
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
#laplace_result$var_matrix
post_samples %>% ggplot(aes(x=mu))+geom_histogram(bins = 55)
post_samples %>% ggplot(aes(x=sigma))+geom_histogram(bins = 55)
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = rep(0, 2) ,
Sigma = diag(2) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(varphi))
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
#laplace_result$var_matrix
post_samples %>% ggplot(aes(x=mu))+geom_histogram(bins = 55)
post_samples %>% ggplot(aes(x=sigma))+geom_histogram(bins = 55)
dnorm(4,mean(post_samples$sigma),0)
laplace_result <-  my_laplace(init_guess_01, my_cv_logpost,hw06_info)
laplace_result$var_matrix(rep(1:2))
laplace_result <-  my_laplace(init_guess_01, my_cv_logpost,hw06_info)
laplace_result$var_matrix(rep(0,2))
laplace_result <-  my_laplace(init_guess_01, my_cv_logpost,hw06_info)
laplace_result$var_matrix(diag(2))
laplace_result <-  my_laplace(init_guess_01, my_cv_logpost,hw06_info)
laplace_result$var_matrix[1,]
#rho_1=
laplace_result <-  my_laplace(init_guess_01, my_cv_logpost,hw06_info)
laplace_result$var_matrix[1,2]
#rho_1=
laplace_result <-  my_laplace(init_guess_01, my_cv_logpost,hw06_info)
laplace_result$var_matrix[2,4]
laplace_result <-  my_laplace(init_guess_01, my_cv_logpost,hw06_info)
laplace_result$var_matrix[2,2]
#rho_1= laplace_result$var_matrix[1,2]/ (sqrt(laplace_result$var_matrix[1,1]))
laplace_result <-  my_laplace(init_guess_01, my_cv_logpost,hw06_info)
rho_1= laplace_result$var_matrix[1,2]/ (sqrt(laplace_result$var_matrix[1,1])*sqrt(laplace_result$var_matrix[2,2]))
laplace_result <-  my_laplace(init_guess_01, my_cv_logpost,hw06_info)
laplace_result
rho_1= laplace_result$var_matrix[1,2]/ (sqrt(laplace_result$var_matrix[1,1])*sqrt(laplace_result$var_matrix[2,2]))
View(post_samples)
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = rep(0, 2) ,
Sigma = diag(2) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(varphi))
return(mu)
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
#laplace_result$var_matrix
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
#laplace_result$var_matrix
post_samples
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = [] ,
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = () ,
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu =  ,
Sigma = diag(2) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(varphi))
return(mu)
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = rep(0, 2) ,
Sigma = diag(2) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(varphi))
return(mu)
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
#laplace_result$var_matrix
post_samples
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = rep(0, 2) ,
Sigma = diag(2) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(varphi))
return(mu)
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
#laplace_result$var_matrix
post_samples
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = rep(0, 2) ,
Sigma = diag(2) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(varphi))
return(Sigma)
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = rep(0, 2) ,
Sigma = diag(2) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(varphi))
return(varphi)
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = rep(0, 2) ,
Sigma = diag(2) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(varphi))
return(mu)
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
#laplace_result$var_matrix
post_samples
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = rep(0, 2) ,
Sigma = diag(2) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(varphi))
return(varphi)
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
a<-pnorm(x_mean, mean=10.855893,
sd=1.090389)
diag(2)
a<-pnorm(x_mean, mean=10.855893,
sd=1.090389)
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = rep(0, 1) ,
Sigma = diag(2) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(varphi))
return(varphi)
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = rep(0, 1) ,
Sigma = diag(2) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(varphi))
return(mu)
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = rep(0, 2) ,
Sigma = diag(2) ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(varphi))
return(mu)
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
#laplace_result$var_matrix
post_samples
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = mvn_info$mode ,
Sigma = mvn_info$var_matrix ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(varphi))
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
#laplace_result$var_matrix
post_samples
post_samples %>% ggplot(aes(x=mu))+geom_histogram(bins = 55)
post_samples %>% ggplot(aes(x=sigma))+geom_histogram(bins = 55)
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = mvn_info$mode[1] ,
Sigma = mvn_info$var_matrix ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(varphi))
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
generate_post_samples <- function(mvn_info, num_samples)
{
MASS::mvrnorm(n = num_samples,
mu = mvn_info$mode ,
Sigma = mvn_info$var_matrix ) %>%
as.data.frame() %>% tibble::as_tibble() %>%
purrr::set_names(c("mu", "varphi")) %>%
mutate(sigma = exp(varphi))
}
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
#laplace_result$var_matrix
post_samples
post_samples %>% ggplot(aes(x=mu))+geom_histogram(bins = 55)
dnorm(4,  laplace_result$mode, laplace_result$var_matrix[2,2] )
dnorm(4,  laplace_result$mode, laplace_result$var_matrix[2,2] )
dnorm(4,  laplace_result$mode[2], laplace_result$var_matrix[2,2] )
dnorm(4,  laplace_result$mode[2], laplace_result$var_matrix[2,2] )
laplace_result$mode[2]
dnorm(4,  laplace_result$mode[2], laplace_result$var_matrix[2,2] )
laplace_result$mode[2]
laplace_result$var_matrix[2,2]
dnorm(4,  laplace_result$mode[2], laplace_result$var_matrix[2,2] )
laplace_result$mode[2]+ laplace_result$var_matrix[2,2]
dnorm(4,  laplace_result$mode[2], laplace_result$var_matrix[2,2] )
laplace_result$mode[2]
laplace_result$var_matrix[2,2]
dnorm(4,  mean(post_samples$sigma) , sd(post_samples$sigma))
pnorm(4,  mean(post_samples$sigma) , sd(post_samples$sigma))
pnorm(4,  mean(post_samples$sigma) , sd(post_samples$sigma, lower.tail=FALSE))
pnorm(4,  mean(post_samples$sigma) , sd(post_samples$sigma), lower.tail=FALSE)
x_mean=mean(hw06_df$x,na.rm=TRUE)
x_sdd= sd(hw06_df$x,na.rm=TRUE)
x_min=min(hw06_df$x,na.rm=TRUE)
x_max= max(hw06_df$x,na.rm=TRUE)
x_mean
x_sdd
x_min
x_max
b=eval_logpost(param_grid$mu, param_grid$sigma, my_logpost,hw06_info)
b
b=eval_logpost(param_grid$mu, param_grid$sigma, my_logpost,hw06_info)
b=eval_logpost(13, 5, my_logpost,hw06_info)
b1=eval_logpost(13, 5, my_logpost,hw06_info)
b1
cv_param_grid %>%
mutate(log_post = log_post_cv_result,
log_post_2 = log_post - max(log_post)) %>%
ggplot(mapping = aes(x = mu, y = varphi)) +
geom_raster(mapping = aes(fill = log_post_2)) +
stat_contour(mapping = aes(z = log_post_2),
breaks = log(c(0.01/100, 0.01, 0.1, 0.5, 0.9)),
size = 2.2,
color = "black") +
# include the sample average (xbar) and the log-sample standard deviation (log_xsd)
geom_point(data = tibble::tibble(xbar = x_mean, log_xsd =log(x_sdd) ),
mapping = aes(x = xbar, y = log_xsd),
shape = 22,
size = 4.5, fill = "orange", color = "steelblue") +
scale_fill_viridis_c(guide = "none", option = "viridis",
limits = log(c(0.01/100, 1.0))) +
labs(x = expression(mu), y = expression(varphi)) +
theme_bw()
map_res_01 <- optim(init_guess_01,my_cv_logpost, gr=NULL, hw06_info,method="BFGS",hessian=TRUE,control=list(fnscale=-1, maxit=1001))
map_res_02 <- optim(init_guess_02,my_cv_logpost, gr=NULL, hw06_info,method="BFGS",hessian=TRUE,control=list(fnscale=-1, maxit=1001))
map_res_01
map_res_02
a<-pnorm(x_mean, mean=10.855893,
sd=1.090389)
pnorm(x_mean, mean=10.855893,
sd=1.090389)
set.seed(202004)
post_samples <- generate_post_samples(laplace_result, 10000)
#laplace_result$var_matrix
summary(post_samples)
eval_logpost <- function(unknown_1, unknown_2, logpost_func, logpost_info){
a <- c()
for (i in 1: length(unknown_1)){
ml=c(unknown_1[i], unknown_2[i])
n=logpost_func(ml, logpost_info)
a[i]=n
}
return(a)}
###
#}
pnorm(x_mean, mean=10.855893,
sd=exp(1.090389))
laplace_result <-  my_laplace(init_guess_01, my_cv_logpost,hw06_info)
laplace_result
rho_1= laplace_result$var_matrix[1,2]/ (sqrt(laplace_result$var_matrix[1,1])*sqrt(laplace_result$var_matrix[2,2]))
laplace_result <-  my_laplace(init_guess_01, my_cv_logpost,hw06_info)
laplace_result
#std1<- sqrt
rho_1= laplace_result$var_matrix[1,2]/ (sqrt(laplace_result$var_matrix[1,1])*sqrt(laplace_result$var_matrix[2,2]))
rho_1
laplace_result <-  my_laplace(init_guess_01, my_cv_logpost,hw06_info)
laplace_result
std1<- sqrt(laplace_result$var_matrix[1,1])
rho_1= laplace_result$var_matrix[1,2]/ (sqrt(laplace_result$var_matrix[1,1])*sqrt(laplace_result$var_matrix[2,2]))
rho_1
laplace_result <-  my_laplace(init_guess_01, my_cv_logpost,hw06_info)
laplace_result
std1<- sqrt(laplace_result$var_matrix[1,1])
rho_1= laplace_result$var_matrix[1,2]/ (sqrt(laplace_result$var_matrix[1,1])*sqrt(laplace_result$var_matrix[2,2]))
rho_1
std1<
laplace_result <-  my_laplace(init_guess_01, my_cv_logpost,hw06_info)
laplace_result
std1 <- sqrt(laplace_result$var_matrix[1,1])
rho_1= laplace_result$var_matrix[1,2]/ (sqrt(laplace_result$var_matrix[1,1])*sqrt(laplace_result$var_matrix[2,2]))
rho_1
std1<
pnorm(4,  mean(post_samples$sigma) , sd(post_samples$sigma), lower.tail=FALSE)
laplace_result <-  my_laplace(init_guess_01, my_cv_logpost,hw06_info)
laplace_result
std1 <- sqrt(laplace_result$var_matrix[1,1])
rho_1= laplace_result$var_matrix[1,2]/ (sqrt(laplace_result$var_matrix[1,1])*sqrt(laplace_result$var_matrix[2,2]))
rho_1
std1<
laplace_result <-  my_laplace(init_guess_01, my_cv_logpost,hw06_info)
laplace_result
std1 <- sqrt(laplace_result$var_matrix[1,1])
rho_1= laplace_result$var_matrix[1,2]/ (sqrt(laplace_result$var_matrix[1,1])*sqrt(laplace_result$var_matrix[2,2]))
rho_1
std1
laplace_result <-  my_laplace(init_guess_01, my_cv_logpost,hw06_info)
laplace_result
std1 <- sqrt(laplace_result$var_matrix[1,1])
std2 <- sqrt(laplace_result$var_matrix[2,2])
rho_1= laplace_result$var_matrix[1,2]/ (sqrt(laplace_result$var_matrix[1,1])*sqrt(laplace_result$var_matrix[2,2]))
rho_1
laplace_result <-  my_laplace(init_guess_01, my_cv_logpost,hw06_info)
laplace_result
std1 <- sqrt(laplace_result$var_matrix[1,1])
std2 <- sqrt(laplace_result$var_matrix[2,2])
rho_1= laplace_result$var_matrix[1,2]/ (sqrt(laplace_result$var_matrix[1,1])*sqrt(laplace_result$var_matrix[2,2]))
rho_1
std1
std2
greater_4<- NROW(post_samples$sigma>4)
greater_4<- NROW(post_sample%>% filter(sigma>4))
greater_4<- NROW(post_samples%>% filter(sigma>4))
greater_4<- NROW(post_samples%>% filter(sigma>4))
prob<-greater_4/NROW(post_samples)
knitr::opts_chunk$set(echo = TRUE)
greater_4<- NROW(post_samples%>% filter(sigma>4))
prob<-greater_4/NROW(post_samples)
prob
